<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Employee Leave</title>
<link rel="icon" type="image/png" href="images/logo.jpeg">

<!-- ✅ Bootstrap 5 CDN -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
body {
  font-family: Arial;
  min-height: 100vh;
  background-color: #0a0f2c;
  color: white;
  margin: 0;
}

.center-wrapper {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 22px;
}

h1 {
  padding-top: 20px;
}

/* Company name */
.company-name {
  font-size: 22px;
  text-align: center;
}

/* Logo */
.center-logo {
  width: 90px;
}

/* Glass card */
.glass-card {
  background: rgba(255,255,255,0.15);
  backdrop-filter: blur(18px);
  border-radius: 16px;
}

/* Inputs */
.form-control, textarea {
  background: rgba(255,255,255,0.2);
  border: 6px solid rgba(22, 194, 65, 0.3);
  color: rgb(200, 190, 190,0.1);
  border-style: outset;
}

.form-control,
.form-control:focus,
textarea,
textarea:focus {
  background-color: rgba(255, 255, 255, 0.1) !important;
  color: #ffffff !important;
  box-shadow: none !important;
}

/* input text color */
input[type="date"] {
  color: #ffffff;
  background-color: rgba(255,255,255,0.2);
}

input[type="date"]::-webkit-datetime-edit {
  color: #e5e7eb;
}

/* date fields */
input[type="date"]::-webkit-datetime-edit-text,
input[type="date"]::-webkit-datetime-edit-month-field,
input[type="date"]::-webkit-datetime-edit-day-field,
input[type="date"]::-webkit-datetime-edit-year-field {
  color: #ffffff;
}

/* calendar icon */
input[type="date"]::-webkit-calendar-picker-indicator {
  filter: invert(1);
  cursor: pointer;
}

.form-control::placeholder {
  color: #d1c9c9;
}

h2,h3 {
  color: #ddd;
}

/* Button */
.btn-custom {
  background: linear-gradient(135deg,#19b044,#3f5efb);
  border: none;
  color: white;
  font-size: large;
}

/* History */
.history-card {
  background: linear-gradient(135deg,#f5f6f7,#082bc9);
  border-radius: 16px;
  padding: 16px;
  margin-top: 14px;
  font-size: 130%;
  position: relative;
}

/* Status badges */
.status {
  display: inline-block;
  padding: 6px 14px;
  border-radius: 20px;
  font-size: 17px;
  font-weight: bold;
}

.pending { background: #f59e0b; color: black; }
.approved { background: #22c55e; color: black; }
.rejected { background: #ef4444; color: black; }

/* Delete button (minimal, no theme change) */
.delete-btn {
  position: absolute;
  top: 12px;
  right: 12px;
  background: transparent;
  border: none;
  color: #000;
  font-size: 14px;
  cursor: pointer;
}
</style>
</head>

<body>

<div class="center-wrapper">

  <h1 class="company-name">
    NESTWORK BUSSINESS SOULTIONS PVT LIMITED
  </h1>

  <img src="logo 1.png">class="center-logo" alt="logo">

  <div class="container">
    <div class="row justify-content-center">
      <div class="col-md-6 col-lg-5">

        <div class="card glass-card p-4">
          <h2 class="text-center mb-3">Employee Leave Request</h2>

          <form onsubmit="submitLeave(event)">
            <input type="text" id="empId" class="form-control mb-2" placeholder="Employee ID" pattern="[0-9]+" required>
            <input type="text" id="empName" class="form-control mb-2" placeholder="Employee Name" required>
            <input type="email" id="email" class="form-control mb-2" placeholder="Employee Email" required>
            <input type="date" id="startDate" class="form-control mb-2" required>
            <input type="date" id="endDate" class="form-control mb-2" required>
            <textarea id="reason" class="form-control mb-3" placeholder="Reason" required></textarea>
            <button type="submit" class="btn btn-custom w-100 py-2">
              Request Leave
            </button>
          </form>

          <h3 class="text-center mt-4">My Leave History</h3>
          <div id="history"></div>
        </div>

      </div>
    </div>
  </div>

</div>

<!-- ✅ Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
function timeAgo(ts) {
  if (!ts) return "";
  const diff = Date.now() - ts;
  const mins = Math.floor(diff / 60000);
  if (mins < 1) return "Just now";
  if (mins < 60) return `${mins} minute(s) ago`;
  const hrs = Math.floor(mins / 60);
  if (hrs < 24) return `${hrs} hour(s) ago`;
  const days = Math.floor(hrs / 24);
  return `${days} day(s) ago`;
}

function submitLeave(e) {
  e.preventDefault();

  const leave = {
    empId: document.getElementById("empId").value,
    name: document.getElementById("empName").value,
    email: document.getElementById("email").value,
    start: document.getElementById("startDate").value,
    end: document.getElementById("endDate").value,
    reason: document.getElementById("reason").value,
    status: "Approved",
    createdAt: Date.now()
  };

  const leaves = JSON.parse(localStorage.getItem("leaves")) || [];
  leaves.push(leave);
  localStorage.setItem("leaves", JSON.stringify(leaves));

  loadHistory();
  e.target.reset();
}

function deleteLeave(index) {
  const leaves = JSON.parse(localStorage.getItem("leaves")) || [];
  leaves.splice(index, 1);
  localStorage.setItem("leaves", JSON.stringify(leaves));
  loadHistory();
}

function loadHistory() {
  const history = document.getElementById("history");
  history.innerHTML = "";

  const leaves = JSON.parse(localStorage.getItem("leaves")) || [];

  leaves.slice().reverse().forEach((l, i) => {
    const actualIndex = leaves.length - 1 - i;

    history.innerHTML += `
      <div class="history-card">
        <button class="delete-btn" onclick="deleteLeave(${actualIndex})">✖</button>
        <div><b>Leave:</b> ${l.start} → ${l.end}</div>
        <div><b>Reason:</b> ${l.reason}</div>
        <div style="font-size:13px;opacity:.8;margin:6px 0">
          Submitted: ${new Date(l.createdAt).toLocaleString()}
          (${timeAgo(l.createdAt)})
        </div>
        <span class="status ${l.status.toLowerCase()}">${l.status}</span>
      </div>
    `;
  });
}

loadHistory();
</script>

</body>
</html>
